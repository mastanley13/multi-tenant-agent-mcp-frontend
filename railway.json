{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "DOCKER"
  },
  "services": {
    "frontend": {
      "name": "ghl-frontend",
      "dockerfile": "client/Dockerfile",
      "domain": {
        "generate": true
      },
      "environmentVariables": {
        "NODE_ENV": "production",
        "NEXT_PUBLIC_MCP_URL": "${{backend.RAILWAY_PUBLIC_DOMAIN}}",
        "NEXT_PUBLIC_SERVER_URL": "${{backend.RAILWAY_PUBLIC_DOMAIN}}",
        "NEXTAUTH_URL": "${{RAILWAY_PUBLIC_DOMAIN}}",
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "NEXTAUTH_SECRET": "${{NEXTAUTH_SECRET}}"
      },
      "healthcheck": {
        "path": "/",
        "timeout": 30
      }
    },
    "backend": {
      "name": "ghl-backend", 
      "dockerfile": "Dockerfile",
      "environmentVariables": {
        "NODE_ENV": "production",
        "BACKEND_PORT": "3001",
        "CLIENT_URL": "${{frontend.RAILWAY_PUBLIC_DOMAIN}}",
        "GHL_BASE_URL": "https://services.leadconnectorhq.com",
        "DATABASE_URL": "${{Postgres.DATABASE_URL}}",
        "OPENAI_API_KEY": "${{OPENAI_API_KEY}}"
      },
      "healthcheck": {
        "path": "/health",
        "timeout": 30
      }
    },
    "mcp-server": {
      "name": "ghl-mcp-server",
      "dockerfile": "backend/mcp-src/Dockerfile",
      "environmentVariables": {
        "NODE_ENV": "production",
        "GHL_BASE_URL": "https://services.leadconnectorhq.com"
      }
    }
  },
  "environments": {
    "production": {
      "services": {
        "frontend": {
          "replicas": 2
        },
        "backend": {
          "replicas": 2
        },
        "mcp-server": {
          "replicas": 1
        }
      }
    }
  }
} 